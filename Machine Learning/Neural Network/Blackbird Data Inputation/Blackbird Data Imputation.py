import numpy as np

rawx = np.array([
    [1, 101],
    [1, 100],
    [1, 98],
    [1, 97],
    [1, 107],
    [0, 94],
    [1, 102],
    [1, 106],
    [0, 96],
    [0, 96],
    [0, 100],
    [0, 105],
    [0, 97],
    [0, 126],
    [0, 104],
    [0, 100]])

rawy = np.array([[135.0, 129.0, 129.0, 129.0, 132.0, 123.0, 129.0, 128.0, 128.0, 128.0, 128.0, 129.0, 127.0, 130.0, 129.0, 130.0]]).T

x = np.array([
    [1, 0, 0.3421052632, 0.3421052632],
    [1, 0, 0.3157894737, 0.3157894737],
    [1, 0, 0.2631578947, 0.3157894737],
    [1, 0, 0.2368421053, 0.2368421053],
    [1, 0, 0.5, 0.5],
    [0, 1, 0.1578947368, 0.1578947368],
    [1, 0, 0.3684210526, 0.3684210526],
    [1, 0, 0.4736842105, 0.4736842105],
    [0, 1, 0.2105263158, 0.2105263158],
    [0, 1, 0.2105263158, 0.2105263158],
    [0, 1, 0.3157894737, 0.3157894737],
    [0, 1, 0.4473684211, 0.4473684211],
    [0, 1, 0.2368421053, 0.2368421053],
    [0, 1, 1.0, 1.0],
    [0, 1, 0.4210526316, 0.4210526316],
    [0, 1, 0.3157894737, 0.3157894737]])

y = np.array([[1.0, 0.5384615385, 0.5384615385, 0.5384615385, 0.7692307692, 0.07692307692, 0.5384615385, 0.4615384615, 0.4615384615, 0.4615384615, 0.4615384615, 0.5384615385, 0.3846153846, 0.6153846154, 0.5384615385, 0.6153846154]]).T

w = np.random.random((4, 5))
w2 = np.random.random((5, 1))
bias = 1

# Training
print(x.shape, w.shape)

for j in xrange(100000): 
    a2 = 1/(1 + np.exp(-(np.dot(x, w) + bias)))
    a3 = 1/(1 + np.exp(-(np.dot(a2, w2) + bias)))
    a3delta = (y - a3) * (a3 * (1 - a3))
    a2delta = a3delta.dot(w2.T) * (a2 * (1 - a2))
    w2 += a2.T.dot(a3delta)
    w += x.T.dot(a2delta)

# Testing

x = np.array([
    [0, 1, 0.4210526316, 0.4210526316],
    [0, 1, 0.2894736842, 0.2894736842],
    [1, 0, 0.4736842105, 0.4736842105],
    [0, 1, 0.38947368421, 0.38947368421]])

a2 = 1/(1 + np.exp(-(np.dot(x, w) + bias)))
a3 = 1/(1 + np.exp(-(np.dot(a2, w2) + bias)))

print(a3 * (135-122) + 122) 

# Application

x = np.array([
    [0, 1, 0, 0]])

a2 = 1/(1 + np.exp(-(np.dot(x, w) + bias)))
a3 = 1/(1 + np.exp(-(np.dot(a2, w2) + bias)))

print(a3 * (135-122) + 122)

print("/n", "124, 122, 127, 130")


